jQuery.fn.extend({everyTime:function(e,t,n,r){return this.each(function(){jQuery.timer.add(this,e,t,n,r)})},oneTime:function(e,t,n){return this.each(function(){jQuery.timer.add(this,e,t,n,1)})},stopTime:function(e,t){return this.each(function(){jQuery.timer.remove(this,e,t)})}}),jQuery.extend({timer:{global:[],guid:1,dataKey:"jQuery.timer",regex:/^([0-9]+(?:\.[0-9]*)?)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1e3,das:1e4,hs:1e5,ks:1e6},timeParse:function(e){if(e==undefined||e==null)return null;var t=this.regex.exec(jQuery.trim(e.toString()));if(t[2]){var n=parseFloat(t[1]),r=this.powers[t[2]]||1;return n*r}return e},add:function(e,t,n,r,i){var s=0;jQuery.isFunction(n)&&(i||(i=r),r=n,n=t),t=jQuery.timer.timeParse(t);if(typeof t!="number"||isNaN(t)||t<0)return;if(typeof i!="number"||isNaN(i)||i<0)i=0;i=i||0;var o=jQuery.data(e,this.dataKey)||jQuery.data(e,this.dataKey,{});o[n]||(o[n]={}),r.timerID=r.timerID||this.guid++;var u=function(){(++s>i&&i!==0||r.call(e,s)===!1)&&jQuery.timer.remove(e,n,r)};u.timerID=r.timerID,o[n][r.timerID]||(o[n][r.timerID]=window.setInterval(u,t)),this.global.push(e)},remove:function(e,t,n){var r=jQuery.data(e,this.dataKey),i;if(r){if(!t)for(t in r)this.remove(e,t,n);else if(r[t]){if(n)n.timerID&&(window.clearInterval(r[t][n.timerID]),delete r[t][n.timerID]);else for(var n in r[t])window.clearInterval(r[t][n]),delete r[t][n];for(i in r[t])break;i||(i=null,delete r[t])}for(i in r)break;i||jQuery.removeData(e,this.dataKey)}}}}),jQuery(window).bind("unload",function(){jQuery.each(jQuery.timer.global,function(e,t){jQuery.timer.remove(t)})}),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,n,r,i){return jQuery.easing[jQuery.easing.def](e,t,n,r,i)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return t==0?n:t==i?n+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;o||(o=i*.3*1.5);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return t<1?-0.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n:u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),(t/=i/2)<1?r/2*t*t*(((s*=1.525)+1)*t-s)+n:r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(e,t,n,r,i){return r-jQuery.easing.easeOutBounce(e,i-t,0,r,i)+n},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(e,t,n,r,i){return t<i/2?jQuery.easing.easeInBounce(e,t*2,0,r,i)*.5+n:jQuery.easing.easeOutBounce(e,t*2-i,0,r,i)*.5+r*.5+n}}),typeof Object.create!="function"&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),function(e){var t=function(e){return this.src={panel:e.attr("src"),frame:e.data("frame")||e.attr("src")},this.scale={panel:null,frame:null},this.height=0,this.width=0,this.attrs={title:e.attr("title")||e.attr("alt"),description:e.data("description")},this.href=null,this.dom_obj=null,this},n={getInt:function(e){return e=parseInt(e,10),isNaN(e)?0:e},innerWidth:function(e){return this.getInt(e.css("width"))||0},outerWidth:function(e){return this.innerWidth(e)+this.extraWidth(e)},extraWidth:function(e){return this.getInt(e.css("paddingLeft"))+this.getInt(e.css("paddingRight"))+this.getInt(e.css("borderLeftWidth"))+this.getInt(e.css("borderRightWidth"))},innerHeight:function(e){return this.getInt(e.css("height"))||0},outerHeight:function(e){return this.innerHeight(e)+this.extraHeight(e)},extraHeight:function(e){return this.getInt(e.css("paddingTop"))+this.getInt(e.css("paddingBottom"))+this.getInt(e.css("borderTopWidth"))+this.getInt(e.css("borderBottomWidth"))}},r={elems:[".gv_galleryWrap",".gv_gallery",".gv_panelWrap",".gv_panel","img.gv_image",".gv_infobar",".gv_filmstripWrap",".gv_filmstrip",".gv_frame",".gv_thumbnail",".gv_caption","img.gv_thumb",".gv_navWrap",".gv_navNext",".gv_navPrev",".gv_navPlay",".gv_panelNavNext",".gv_panelNavPrev",".gv_overlay",".gv_showOverlay",".gv_imageStore"],createElem:function(t,n){n=document.createElement(n);var r=e(n);return r.attr(t)},getPos:function(e){var t=this,n=this.dom,e=e[0],r=e.id,i=0,s=0,o,u,a;if(!e)return{top:0,left:0};if(e.offsetParent)do i+=e.offsetLeft,s+=e.offsetTop;while(e=e.offsetParent);return r===t.id?{left:i,top:s}:(o=t.getPos(n.galleryWrap),u=o.left,a=o.top,{left:i-u,top:s-a})},mouseIsOverGallery:function(e,t){var r=this,i=this.dom,s=this.getPos(i.gv_galleryWrap),o=s.top,u=s.left;return e>u&&e<u+n.outerWidth(i.gv_galleryWrap)&&t>o&&t<o+n.outerHeight(i.gv_galleryWrap)},mouseIsOverPanel:function(e,t){var r=this,i=this.dom,s=this.getPos(i.gv_panelWrap),o=this.getPos(i.gv_galleryWrap),u=s.top+o.top,a=s.left+o.left;return e>a&&e<a+n.outerWidth(i.gv_panelWrap)&&t>u&&t<u+n.outerHeight(i.gv_panelWrap)},storeImages:function(){var n=this;this.sourceImgs=e("li>img",this.$el),this.numImages=this.sourceImgs.length,this.gvImages=[],this.sourceImgs.each(function(r,i){n.gvImages[r]=new t(e(i))})},setDimensions:function(){var t=this,r=this.dom,i={prev:n.innerWidth(r.gv_navPrev),play:n.innerWidth(r.gv_navPlay),next:n.innerWidth(r.gv_navNext),filmstrip:this.opts.frame_width,fsMax:0,fsFull:0},s={prev:n.innerHeight(r.gv_navPrev),play:n.innerHeight(r.gv_navPlay),next:n.innerHeight(r.gv_navNext),filmstrip:this.opts.frame_height+(this.opts.show_captions?n.outerHeight(r.gv_caption):0),fsMax:0,fsFull:0},o=[];this.filmstripOrientation==="horizontal"?r.gv_navWrap.css({width:i.prev+i.play+i.next,height:Math.max(s.prev,s.play,s.next)}):this.opts.filmstrip_style==="scroll"&&this.opts.frame_width<i.prev+i.play+i.next?r.gv_navWrap.css({width:Math.max(i.prev,i.play,i.next),height:s.prev+s.play+s.next}):r.gv_navWrap.css({width:i.prev+i.play+i.next,height:Math.max(s.prev,s.play,s.next)}),this.filmstripOrientation==="vertical"&&i.filmstrip<i.prev+i.play+i.next?r.gv_navWrap.css({width:Math.max(i.prev,i.play,i.next),height:s.prev+s.play+s.next}):r.gv_navWrap.css({width:i.prev+i.play+i.next,height:Math.max(s.prev,s.play,s.next)}),r.gv_panel.css({width:this.opts.panel_width,height:this.opts.panel_height}),r.gv_panelWrap.css({width:n.outerWidth(r.gv_panel),height:n.outerHeight(r.gv_panel)}),r.gv_overlay.css({width:this.opts.panel_width}),e.each(this.gvImages,function(e,t){r.gv_panelWrap.append(r.gv_panel.clone(!0))}),r.gv_panels=r.gv_panelWrap.find(".gv_panel"),r.gv_panels.remove(),r.gv_thumbnail.css({width:this.opts.frame_width,height:this.opts.frame_height}),r.gv_frame.css({width:n.outerWidth(r.gv_thumbnail),height:n.outerHeight(r.gv_thumbnail)+(this.opts.show_captions?n.outerHeight(r.gv_caption):0),marginRight:this.opts.frame_gap,marginBottom:this.opts.frame_gap}),this.filmstripOrientation==="horizontal"?(this.filmstripSize=Math.floor((n.outerWidth(r.gv_panelWrap)-n.outerWidth(r.gv_navWrap))/(n.outerWidth(r.gv_frame)+this.opts.frame_gap)),i.fsMax=this.filmstripSize*(n.outerWidth(r.gv_frame)+this.opts.frame_gap),i.fsFull=this.gvImages.length*(n.outerWidth(r.gv_frame)+this.opts.frame_gap),i.filmstrip=Math.min(i.fsMax,i.fsFull),this.opts.filmstrip_style!=="scroll"&&(s.filmstrip=Math.ceil(this.gvImages.length/this.filmstripSize)*(n.outerHeight(r.gv_frame)+this.opts.frame_gap)-this.opts.frame_gap)):(this.filmstripSize=Math.floor((n.outerHeight(r.gv_panelWrap)-n.outerHeight(r.gv_navWrap))/(n.outerHeight(r.gv_frame)+this.opts.frame_gap)),s.fsMax=this.filmstripSize*(n.outerHeight(r.gv_frame)+this.opts.frame_gap),s.fsFull=this.gvImages.length*(n.outerHeight(r.gv_frame)+this.opts.frame_gap),s.filmstrip=Math.min(s.fsMax,s.fsFull),this.opts.filmstrip_style!=="scroll"&&(i.filmstrip=Math.ceil(this.gvImages.length/this.filmstripSize)*(n.outerWidth(r.gv_frame)+this.opts.frame_gap)-this.opts.frame_gap)),r.gv_filmstripWrap.css({width:i.filmstrip,height:s.filmstrip}),this.opts.show_filmstrip?this.filmstripOrientation==="horizontal"?r.gv_gallery.css({width:n.outerWidth(r.gv_panelWrap),height:n.outerHeight(r.gv_panelWrap)+this.opts.frame_gap+(this.opts.show_filmstrip?Math.max(n.outerHeight(r.gv_filmstripWrap),n.outerHeight(r.gv_navWrap)):n.outerHeight(r.gv_filmstripWrap))}):r.gv_gallery.css({width:n.outerWidth(r.gv_panelWrap)+this.opts.frame_gap+(this.opts.show_filmstrip?Math.max(n.outerWidth(r.gv_filmstripWrap),n.outerWidth(r.gv_navWrap)):n.outerWidth(r.gv_filmstripWrap)),height:n.outerHeight(r.gv_panelWrap)}):r.gv_gallery.css({width:n.outerWidth(r.gv_panelWrap),height:n.outerHeight(r.gv_panelWrap)}),r.gv_galleryWrap.css({width:n.outerWidth(r.gv_gallery),height:n.outerHeight(r.gv_gallery),padding:this.opts.frame_gap})},setPositions:function(){var e=this,t=this.dom,r=0,i=0,s=0,o=0,u,a;this.filmstripOrientation==="horizontal"?(u=Math.round((n.outerHeight(t.gv_filmstripWrap)-n.outerHeight(t.gv_navWrap))/2),u<0?i=-1*u:r=u):(a=Math.round((n.outerWidth(t.gv_filmstripWrap)-n.outerWidth(t.gv_navWrap))/2),a<0?o=-1*a:s=a),!this.opts.show_filmstrip_nav&&this.filmstripOrientation==="horizontal"&&(o=Math.floor((n.outerWidth(t.gv_panelWrap)-n.outerWidth(t.gv_filmstripWrap))/2)),t.gv_panelNavNext.css({top:(n.outerHeight(t.gv_panel)-n.outerHeight(t.gv_panelNavNext))/2,right:10}),t.gv_panelNavPrev.css({top:(n.outerHeight(t.gv_panel)-n.outerHeight(t.gv_panelNavPrev))/2,left:10});switch(this.opts.filmstrip_position){case"top":t.gv_navWrap.css({top:r,right:s}),t.gv_panelWrap.css({bottom:0,left:0}),t.gv_filmstripWrap.css({top:i,left:o});break;case"right":t.gv_navWrap.css({bottom:r,right:s}),t.gv_panelWrap.css({top:0,left:0}),t.gv_filmstripWrap.css({top:i,right:o});break;case"left":t.gv_navWrap.css({bottom:r,left:s}),t.gv_panelWrap.css({top:0,right:0}),t.gv_filmstripWrap.css({top:i,left:o});break;default:t.gv_navWrap.css({bottom:r,right:s}),t.gv_panelWrap.css({top:0,left:0}),t.gv_filmstripWrap.css({bottom:i,left:o})}this.opts.overlay_position==="top"?(t.gv_overlay.css({top:0,left:-99999}),t.gv_showOverlay.css({top:0,left:0})):(t.gv_overlay.css({bottom:0,left:-99999}),t.gv_showOverlay.css({bottom:0,left:0})),this.opts.show_filmstrip_nav||t.gv_navWrap.remove()},buildFilmstrip:function(){var t=this,r=this.dom,i=this.gvImages.length*((this.filmstripOrientation==="horizontal"?this.opts.frame_width:this.opts.frame_height)+this.opts.frame_gap);r.gv_frame.append(r.gv_thumbnail),this.opts.show_captions&&r.gv_frame.append(r.gv_caption),r.gv_thumbnail.css("opacity",this.opts.frame_opacity),r.gv_thumbnail.bind({mouseover:function(){e(this).hasClass("current")||e(this).stop().animate({opacity:1},250)},mouseout:function(){e(this).hasClass("current")||e(this).stop().animate({opacity:t.opts.frame_opacity},250)}}),e.each(this.gvImages,function(e,t){r.gv_frame.clone(!0).prependTo(r.gv_filmstrip)}),r.gv_filmstrip.css({width:n.outerWidth(r.gv_frame),height:n.outerHeight(r.gv_frame)}),this.opts.filmstrip_style==="scroll"?this.filmstripOrientation==="horizontal"?i>n.innerWidth(r.gv_filmstripWrap)?(r.gv_filmstrip.find(".gv_frame").clone(!0).appendTo(r.gv_filmstrip).clone(!0).appendTo(r.gv_filmstrip),r.gv_filmstrip.css("width",i*3),this.scrolling=!0):r.gv_filmstrip.css("width",i):i>n.innerHeight(r.gv_filmstripWrap)?(r.gv_filmstrip.find(".gv_frame").clone(!0).appendTo(r.gv_filmstrip).clone(!0).appendTo(r.gv_filmstrip),r.gv_filmstrip.css("height",i*3),this.scrolling=!0):r.gv_filmstrip.css("height",i):r.gv_filmstrip.css({width:parseInt(r.gv_filmstripWrap.css("width"),10)+this.opts.frame_gap,height:parseInt(r.gv_filmstripWrap.css("height"),10)+this.opts.frame_gap}),r.gv_frames=r.gv_filmstrip.find(".gv_frame"),e.each(r.gv_frames,function(t,n){e(n).data("frameIndex",t)}),r.gv_thumbnails=r.gv_filmstrip.find("div.gv_thumbnail")},buildGallery:function(){var e=this,t=this.dom;this.setDimensions(),this.setPositions(),this.opts.show_filmstrip&&this.buildFilmstrip()},showInfoBar:function(){if(!this.opts.show_infobar)return;var e=this,t=this.dom;t.gv_infobar.stop().stopTime("hideInfoBar_"+e.id).html(this.iterator+1+" of "+this.numImages).show().css("opacity",this.opts.infobar_opacity),t.gv_infobar.oneTime(2e3+this.opts.transition_speed,"hideInfoBar_"+e.id,function(){t.gv_infobar.fadeOut(1e3)})},initImages:function(){var t=this,r=this.dom;e.each(this.gvImages,function(i,s){var o=e("<img/>");o.css("visibility","hidden").data("index",i),o.bind("load.galleryview",function(){var i=e(this),o=i.data("index"),u=this.width,a=this.height,f=r[i.data("parent").type].eq(i.data("parent").index),l=n.innerWidth(f)/u,c=n.innerHeight(f)/a,h=f.hasClass("gv_panel")?"panel":"frame",p=0,d=0;s.scale[h]=t.opts[h+"_scale"]==="fit"?Math.min(l,c):Math.max(l,c),d=Math.round((n.innerWidth(f)-u*s.scale[h])/2),p=Math.round((n.innerHeight(f)-a*s.scale[h])/2),i.css({width:u*s.scale[h],height:a*s.scale[h],top:p,left:d}),i.hide().css("visibility","visible"),i.remove().appendTo(f),h==="frame"?(i.fadeIn(),f.parent().removeClass("gv_frame-loading"),f.parent().find(".gv_caption").html(s.attrs.title)):o===t.opts.start_frame-1?(f.prependTo(r.gv_panelWrap),f.removeClass("gv_panel-loading"),i.fadeIn(),t.showInfoBar()):(f.removeClass("gv_panel-loading"),i.show())}),t.opts.show_panels&&o.clone(!0).data("parent",{type:"gv_panels",index:i}).appendTo(r.gv_imageStore).attr("src",s.src.panel),t.opts.show_filmstrip&&(o.clone(!0).data("parent",{type:"gv_thumbnails",index:i}).appendTo(r.gv_imageStore).attr("src",s.src.frame),r.gv_frames.length>r.gv_panels.length&&(o.clone(!0).data("parent",{type:"gv_thumbnails",index:i+t.numImages}).appendTo(r.gv_imageStore).attr("src",s.src.frame),o.clone(!0).data("parent",{type:"gv_thumbnails",index:i+t.numImages+t.numImages}).appendTo(r.gv_imageStore).attr("src",s.src.frame)))})},showNext:function(){this.navAction="next",this.showItem(this.frameIterator+1)},showPrev:function(){this.navAction="prev",this.showItem(this.frameIterator-1)},showItem:function(t){if(isNaN(t))return;this.opts.show_filmstrip||(t%=this.numImages);var r=this,i=this.dom,s=t,o,u,a,f,l=!1;t>=this.numImages?t%=this.numImages:t<0&&(t=this.numImages-1,i.gv_frames!=undefined?s=i.gv_frames.length-1:s=i.gv_panels.length-1),f=i.gv_panels.eq(t),l=this.playing,l&&this.stopSlideshow(!1),this.unbindActions(),i.gv_gallery.oneTime(this.opts.transition_speed,"bindActions_"+r.id,function(){l&&r.startSlideshow(!1),r.bindActions()});switch(this.opts.panel_animation){case"crossfade":i.gv_panels.eq(this.iterator).fadeOut(this.opts.transition_speed,function(){e(this).remove()}),f.hide().prependTo(i.gv_panelWrap).fadeIn(this.opts.transition_speed);break;case"fade":i.gv_panels.eq(this.iterator).remove(),f.hide().prependTo(i.gv_panelWrap).fadeIn(this.opts.transition_speed);break;case"slide":this.navAction==="next"||this.navAction==="frame"&&s>this.iterator?(o=n.outerWidth(i.gv_panel),u=-1*n.outerWidth(i.gv_panel)):(o=-1*n.outerWidth(i.gv_panel),u=n.outerWidth(i.gv_panel)),f.css({left:o}).appendTo(i.gv_panelWrap).animate({left:0},{duration:this.opts.transition_speed,easing:this.opts.easing}),i.gv_panels.eq(this.iterator).animate({left:u},{duration:this.opts.transition_speed,easing:this.opts.easing,complete:function(){e(this).remove()}});break;default:i.gv_panels.eq(this.iterator).remove(),f.prependTo(i.gv_panelWrap)}this.updateOverlay(t),this.iterator=t,this.updateFilmstrip(s),this.showInfoBar()},updateOverlay:function(e){var t=this,n=this.dom;this.overlayVisible?this.hideOverlay(null,function(){n.gv_overlay.html("<h4>"+t.gvImages[e].attrs.title+"</h4><p>"+t.gvImages[e].attrs.description+"</p>"),t.showOverlay()}):(n.gv_overlay.html("<h4>"+t.gvImages[e].attrs.title+"</h4><p>"+t.gvImages[e].attrs.description+"</p>"),n.gv_overlay.css(this.opts.overlay_position,-1*n.gv_overlay.outerHeight()))},hideOverlay:function(e,t){var n=this,r=this.dom,i={},s={},o=e||n.opts.transition_speed/2;t=t||function(){},i[this.opts.overlay_position]=-1*r.gv_overlay.outerHeight(),s[this.opts.overlay_position]=0,r.gv_overlay.animate(i,{duration:o,easing:"swing",complete:t}),r.gv_showOverlay.animate(s,{duration:o,easing:"swing"}),this.overlayVisible=!1},showOverlay:function(e){var t=this,n=this.dom,r={},i={},s={},o=e||t.opts.transition_speed/2;r[this.opts.overlay_position]=-1*n.gv_overlay.outerHeight(),r.left=0,i[this.opts.overlay_position]=0,s[this.opts.overlay_position]=n.gv_overlay.outerHeight(),n.gv_overlay.css(r),n.gv_overlay.animate(i,{duration:o,easing:"swing"}),n.gv_showOverlay.animate(s,{duration:o,easing:"swing"}),this.overlayVisible=!0},updateFilmstrip:function(e){if(!this.opts.show_filmstrip){this.frameIterator=e;return}var t=this,r=this.dom,i=r.gv_thumbnails.eq(this.iterator),s,o;this.scrolling&&(i=i.add(r.gv_thumbnails.eq(this.iterator+this.numImages)).add(r.gv_thumbnails.eq(this.iterator+2*this.numImages))),r.gv_thumbnails.removeClass("current").animate({opacity:this.opts.frame_opacity}),i.stop().addClass("current").animate({opacity:1},500),this.scrolling?this.filmstripOrientation==="horizontal"?(o=(n.outerWidth(r.gv_frame)+this.opts.frame_gap)*(this.frameIterator-e),o>0?o="+="+Math.abs(o):o="-="+Math.abs(o),r.gv_filmstrip.animate({left:o},{duration:this.opts.transition_speed,easing:this.opts.easing,complete:function(){e<t.numImages?r.gv_filmstrip.css("left",n.getInt(r.gv_filmstrip.css("left"))-t.numImages*(n.outerWidth(r.gv_frame)+t.opts.frame_gap)):e>=t.numImages*2&&r.gv_filmstrip.css("left",n.getInt(r.gv_filmstrip.css("left"))+t.numImages*(n.outerWidth(r.gv_frame)+t.opts.frame_gap)),t.frameIterator=e%t.numImages+t.numImages}})):(o=(n.outerHeight(r.gv_frame)+this.opts.frame_gap)*(this.frameIterator-e),o>0?o="+="+Math.abs(o):o="-="+Math.abs(o),r.gv_filmstrip.animate({top:o},{duration:this.opts.transition_speed,easing:this.opts.easing,complete:function(){e===0?(r.gv_filmstrip.css("top",n.getInt(r.gv_filmstrip.css("top"))-t.numImages*(n.outerHeight(r.gv_frame)+t.opts.frame_gap)),t.frameIterator=t.numImages):e>t.numImages*3-t.filmstripSize*2?(r.gv_filmstrip.css("top",n.getInt(r.gv_filmstrip.css("top"))+t.numImages*(n.outerHeight(r.gv_frame)+t.opts.frame_gap)),t.frameIterator=e-t.numImages):t.frameIterator=e}})):this.frameIterator=e},startSlideshow:function(e){var t=this,n=this.dom;if(!t.opts.enable_slideshow)return;e&&n.gv_navPlay.removeClass("gv_navPlay").addClass("gv_navPause"),this.playing=!0,n.gv_galleryWrap.everyTime(this.opts.transition_interval,"slideshow_"+this.id,function(){t.showNext()})},stopSlideshow:function(e){var t=this,n=this.dom;e&&n.gv_navPlay.removeClass("gv_navPause").addClass("gv_navPlay"),this.playing=!1,n.gv_galleryWrap.stopTime("slideshow_"+this.id)},enablePanning:function(){var t=this,r=this.dom;if(!t.opts.enable_slideshow)return;r.gv_panel.css("cursor","url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur), n-resize"),this.opts.pan_style==="drag"&&r.gv_panelWrap.delegate(".gv_panel img","mousedown.galleryview",function(n){t.isMouseDown=!0,e(this).css("cursor","url(http://www.google.com/intl/en_ALL/mapfiles/closedhand.cur), n-resize")}).delegate(".gv_panel img","mouseup.galleryview",function(n){t.isMouseDown=!1,e(this).css("cursor","url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur), n-resize")}).delegate(".gv_panel img","mousemove.galleryview",function(i){var s,o,u=e(this),a,f;t.isMouseDown?(s=i.pageY-t.mouse.y,o=i.pageX-t.mouse.x,a=n.getInt(u.css("top"))+s,f=n.getInt(u.css("left"))+o,u.css("cursor","url(http://www.google.com/intl/en_ALL/mapfiles/closedhand.cur), n-resize"),a>0&&(a=0),f>0&&(f=0),a<-1*(n.outerHeight(u)-n.innerHeight(r.gv_panel))&&(a=-1*(n.outerHeight(u)-n.innerHeight(r.gv_panel))),f<-1*(n.outerWidth(u)-n.innerWidth(r.gv_panel))&&(f=-1*(n.outerWidth(u)-n.innerWidth(r.gv_panel))),u.css("top",a),u.css("left",f)):u.css("cursor","url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur), n-resize")})},bindActions:function(){var t=this,n=this.dom;n.gv_showOverlay.bind("click.galleryview",function(){t.overlayVisible?t.hideOverlay(250):t.showOverlay(250)}),n.gv_navWrap.delegate("div","click.galleryview",function(){var n=e(this);return n.hasClass("gv_navNext")?t.showNext():n.hasClass("gv_navPrev")?t.showPrev():n.hasClass("gv_navPlay")?t.startSlideshow(!0):n.hasClass("gv_navPause")&&t.stopSlideshow(!0),!1}),n.gv_panelNavNext.bind("click.galleryview",function(){return t.showNext(),!1}),n.gv_panelNavPrev.bind("click.galleryview",function(){return t.showPrev(),!1}),n.gv_filmstripWrap.delegate(".gv_frame","click.galleryview",function(){var n=e(this),r=n.data("frameIndex");return this.navAction="frame",t.showItem(r),!1}),n.gv_panelWrap.bind("mouseover.galleryview",function(){t.showPanelNav()}).bind("mouseout.galleryview",function(){t.hidePanelNav()})},unbindActions:function(){var e=this,t=this.dom;t.gv_showOverlay.unbind("click.galleryview"),t.gv_panelNavNext.unbind("click.galleryview"),t.gv_panelNavPrev.unbind("click.galleryview"),t.gv_navWrap.undelegate("div","click.galleryview"),t.gv_filmstripWrap.undelegate(".gv_frame","click.galleryview")},showPanelNav:function(){var e=this,t=this.dom;t.gv_panelNavNext.show(),t.gv_panelNavPrev.show()},hidePanelNav:function(){var e=this,t=this.dom;t.gv_panelNavNext.hide(),t.gv_panelNavPrev.hide()},init:function(t,n){var r=this,i=this.dom={};this.opts=e.extend({},e.fn.galleryView.defaults,t),this.el=n,this.$el=e(n),this.id=n.id,this.iterator=this.frameIterator=this.opts.start_frame-1,this.overlayVisible=!1,this.playing=!1,this.scrolling=!1,this.isMouseDown=!1,this.mouse={x:0,y:0},this.filmstripOrientation=this.opts.filmstrip_position==="top"||this.opts.filmstrip_position==="bottom"?"horizontal":"vertical",e(document).bind("mousemove.galleryview",function(e){r.mouse={x:e.pageX,y:e.pageY}}),e.each(this.elems,function(e,t){var t=t.split(".");t[0]===""&&(t[0]="div"),i[t[1]]=r.createElem({"class":t[1]},t[0])}),i.gv_imageStore.appendTo(e("body")),i.gv_galleryWrap.delegate("img","mousedown.galleryview",function(e){e.preventDefault&&e.preventDefault()}),i.gv_panel.addClass("gv_panel-loading"),i.gv_frame.addClass("gv_frame-loading"),i.gv_galleryWrap.hide().append(i.gv_gallery),this.opts.show_panels&&(i.gv_gallery.append(i.gv_panelWrap),this.opts.show_panel_nav&&i.gv_panelWrap.append(i.gv_panelNavNext,i.gv_panelNavPrev),this.opts.show_infobar&&i.gv_panelWrap.append(i.gv_infobar)),this.opts.show_filmstrip&&(i.gv_gallery.append(i.gv_filmstripWrap.append(i.gv_filmstrip)),this.opts.show_filmstrip_nav&&i.gv_gallery.append(i.gv_navWrap.append(i.gv_navPrev,this.opts.enable_slideshow?i.gv_navPlay:e("<span></span>"),i.gv_navNext))),this.opts.enable_overlays&&i.gv_panelWrap.append(i.gv_overlay,i.gv_showOverlay),this.opts.show_captions&&i.gv_frame.append(i.gv_caption).appendTo(i.gv_gallery),this.$el.replaceWith(i.gv_galleryWrap),this.opts.pan_images&&this.enablePanning(),this.storeImages(),this.buildGallery(),this.initImages(),this.bindActions(),i.gv_frame.remove(),i.gv_galleryWrap.show(),this.opts.autoplay&&this.startSlideshow(!0),this.updateOverlay(this.iterator),this.updateFilmstrip(this.frameIterator)}};e.fn.galleryView=function(e){if(this.length)return this.each(function(){var t=Object.create(r);t.init(e,this)})},e.fn.galleryView.defaults={transition_speed:1e3,transition_interval:5e3,easing:"swing",show_panels:!0,show_panel_nav:!0,enable_overlays:!1,panel_width:800,panel_height:400,panel_animation:"fade",panel_scale:"crop",overlay_position:"bottom",pan_images:!1,pan_style:"drag",pan_smoothness:15,start_frame:1,show_filmstrip:!0,show_filmstrip_nav:!0,enable_slideshow:!0,autoplay:!1,show_captions:!1,filmstrip_size:3,filmstrip_style:"scroll",filmstrip_position:"bottom",frame_width:80,frame_height:40,frame_opacity:.4,frame_scale:"crop",frame_gap:5,show_infobar:!0,infobar_opacity:1}}(jQuery),window.Modernizr=function(e,t,n){function k(e){l.cssText=e}function L(e,t){return k(d.join(e+";")+(t||""))}function A(e,t){return typeof e===t}function O(e,t){return!!~(""+e).indexOf(t)}function M(e,t){for(var r in e)if(l[e[r]]!==n)return t=="pfx"?e[r]:!0;return!1}function _(e,t){var n=e.charAt(0).toUpperCase()+e.substr(1),r=(e+" "+v.join(n+" ")+n).split(" ");return M(r,t)}function P(){i.input=function(e){for(var t=0,n=e.length;t<n;t++)b[e[t]]=e[t]in c;return b}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),i.inputtypes=function(e){for(var r=0,i,s,u,a=e.length;r<a;r++)c.setAttribute("type",s=e[r]),i=c.type!=="text",i&&(c.value=h,c.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&c.style.WebkitAppearance!==n?(o.appendChild(c),u=t.defaultView,i=u.getComputedStyle&&u.getComputedStyle(c,null).WebkitAppearance!=="textfield"&&c.offsetHeight!==0,o.removeChild(c)):/^(search|tel)$/.test(s)||(/^(url|email)$/.test(s)?i=c.checkValidity&&c.checkValidity()===!1:/^color$/.test(s)?(o.appendChild(c),o.offsetWidth,i=c.value!=h,o.removeChild(c)):i=c.value!=h)),y[e[r]]=!!i;return y}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var r="2.0.6",i={},s=!0,o=t.documentElement,u=t.head||t.getElementsByTagName("head")[0],a="modernizr",f=t.createElement(a),l=f.style,c=t.createElement("input"),h=":)",p=Object.prototype.toString,d=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),v="Webkit Moz O ms Khtml".split(" "),m={svg:"http://www.w3.org/2000/svg"},g={},y={},b={},w=[],E,S=function(e,n,r,i){var s,u,f,l=t.createElement("div");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:a+(r+1),l.appendChild(f);return s=["&shy;","<style>",e,"</style>"].join(""),l.id=a,l.innerHTML+=s,o.appendChild(l),u=n(l,e),l.parentNode.removeChild(l),!!u},x=function(t){if(e.matchMedia)return matchMedia(t).matches;var n;return S("@media "+t+" { #"+a+" { position: absolute; } }",function(t){n=(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle)["position"]=="absolute"}),n},T=function(){function r(r,i){i=i||t.createElement(e[r]||"div"),r="on"+r;var s=r in i;return s||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(r,""),s=A(i[r],"function"),A(i[r],n)||(i[r]=n),i.removeAttribute(r))),i=null,s}var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r}(),N={}.hasOwnProperty,C;!A(N,n)&&!A(N.call,n)?C=function(e,t){return N.call(e,t)}:C=function(e,t){return t in e&&A(e.constructor.prototype[t],n)};var D=function(n,r){var s=n.join(""),o=r.length;S(s,function(n,r){var s=t.styleSheets[t.styleSheets.length-1],u=s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"",a=n.childNodes,f={};while(o--)f[a[o].id]=a[o];i.touch="ontouchstart"in e||f.touch.offsetTop===9,i.csstransforms3d=f.csstransforms3d.offsetLeft===9,i.generatedcontent=f.generatedcontent.offsetHeight>=1,i.fontface=/src/i.test(u)&&u.indexOf(r.split(" ")[0])===0},o,r)}(['@font-face {font-family:"font";src:url("https://")}',["@media (",d.join("touch-enabled),("),a,")","{#touch{top:9px;position:absolute}}"].join(""),["@media (",d.join("transform-3d),("),a,")","{#csstransforms3d{left:9px;position:absolute}}"].join(""),['#generatedcontent:after{content:"',h,'";visibility:hidden}'].join("")],["fontface","touch","csstransforms3d","generatedcontent"]);g.flexbox=function(){function e(e,t,n,r){t+=":",e.style.cssText=(t+d.join(n+";"+t)).slice(0,-t.length)+(r||"")}function n(e,t,n,r){e.style.cssText=d.join(t+":"+n+";")+(r||"")}var r=t.createElement("div"),i=t.createElement("div");e(r,"display","box","width:42px;padding:0;"),n(i,"box-flex","1","width:10px;"),r.appendChild(i),o.appendChild(r);var s=i.offsetWidth===42;return r.removeChild(i),o.removeChild(r),s},g.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},g.canvastext=function(){return!!i.canvas&&!!A(t.createElement("canvas").getContext("2d").fillText,"function")},g.webgl=function(){return!!e.WebGLRenderingContext},g.touch=function(){return i.touch},g.geolocation=function(){return!!navigator.geolocation},g.postmessage=function(){return!!e.postMessage},g.websqldatabase=function(){var t=!!e.openDatabase;return t},g.indexedDB=function(){for(var t=-1,n=v.length;++t<n;)if(e[v[t].toLowerCase()+"IndexedDB"])return!0;return!!e.indexedDB},g.hashchange=function(){return T("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},g.history=function(){return!!e.history&&!!history.pushState},g.draganddrop=function(){return T("dragstart")&&T("drop")},g.websockets=function(){for(var t=-1,n=v.length;++t<n;)if(e[v[t]+"WebSocket"])return!0;return"WebSocket"in e},g.rgba=function(){return k("background-color:rgba(150,255,150,.5)"),O(l.backgroundColor,"rgba")},g.hsla=function(){return k("background-color:hsla(120,40%,100%,.5)"),O(l.backgroundColor,"rgba")||O(l.backgroundColor,"hsla")},g.multiplebgs=function(){return k("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(l.background)},g.backgroundsize=function(){return _("backgroundSize")},g.borderimage=function(){return _("borderImage")},g.borderradius=function(){return _("borderRadius")},g.boxshadow=function(){return _("boxShadow")},g.textshadow=function(){return t.createElement("div").style.textShadow===""},g.opacity=function(){return L("opacity:.55"),/^0.55$/.test(l.opacity)},g.cssanimations=function(){return _("animationName")},g.csscolumns=function(){return _("columnCount")},g.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return k((e+d.join(t+e)+d.join(n+e)).slice(0,-e.length)),O(l.backgroundImage,"gradient")},g.cssreflections=function(){return _("boxReflect")},g.csstransforms=function(){return!!M(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])},g.csstransforms3d=function(){var e=!!M(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);return e&&"webkitPerspective"in o.style&&(e=i.csstransforms3d),e},g.csstransitions=function(){return _("transitionProperty")},g.fontface=function(){return i.fontface},g.generatedcontent=function(){return i.generatedcontent},g.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType){n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"');var r='video/mp4; codecs="avc1.42E01E';n.h264=e.canPlayType(r+'"')||e.canPlayType(r+', mp4a.40.2"'),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"')}}catch(i){}return n},g.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"'),n.mp3=e.canPlayType("audio/mpeg;"),n.wav=e.canPlayType('audio/wav; codecs="1"'),n.m4a=e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")}catch(r){}return n},g.localstorage=function(){try{return!!localStorage.getItem}catch(e){return!1}},g.sessionstorage=function(){try{return!!sessionStorage.getItem}catch(e){return!1}},g.webworkers=function(){return!!e.Worker},g.applicationcache=function(){return!!e.applicationCache},g.svg=function(){return!!t.createElementNS&&!!t.createElementNS(m.svg,"svg").createSVGRect},g.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==m.svg},g.smil=function(){return!!t.createElementNS&&/SVG/.test(p.call(t.createElementNS(m.svg,"animate")))},g.svgclippaths=function(){return!!t.createElementNS&&/SVG/.test(p.call(t.createElementNS(m.svg,"clipPath")))};for(var H in g)C(g,H)&&(E=H.toLowerCase(),i[E]=g[H](),w.push((i[E]?"":"no-")+E));return i.input||P(),i.addTest=function(e,t){if(typeof e=="object")for(var r in e)C(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return;t=typeof t=="boolean"?t:!!t(),o.className+=" "+(t?"":"no-")+e,i[e]=t}return i},k(""),f=c=null,e.attachEvent&&function(){var e=t.createElement("div");return e.innerHTML="<elem></elem>",e.childNodes.length!==1}()&&function(e,t){function y(e){var t=-1;while(++t<o)e.createElement(s[t])}e.iepp=e.iepp||{};var r=e.iepp,i=r.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",s=i.split("|"),o=s.length,u=new RegExp("(^|\\s)("+i+")","gi"),a=new RegExp("<(/*)("+i+")","gi"),f=/^\s*[\{\}]\s*$/,l=new RegExp("(^|[^\\n]*?\\s)("+i+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),c=t.createDocumentFragment(),h=t.documentElement,p=h.firstChild,d=t.createElement("body"),v=t.createElement("style"),m=/print|all/,g;r.getCSS=function(e,t){if(e+""===n)return"";var i=-1,s=e.length,o,u=[];while(++i<s){o=e[i];if(o.disabled)continue;t=o.media||t,m.test(t)&&u.push(r.getCSS(o.imports,t),o.cssText),t="all"}return u.join("")},r.parseCSS=function(e){var t=[],n;while((n=l.exec(e))!=null)t.push(((f.exec(n[1])?"\n":n[1])+n[2]+n[3]).replace(u,"$1.iepp_$2")+n[4]);return t.join("\n")},r.writeHTML=function(){var e=-1;g=g||t.body;while(++e<o){var n=t.getElementsByTagName(s[e]),r=n.length,i=-1;while(++i<r)n[i].className.indexOf("iepp_")<0&&(n[i].className+=" iepp_"+s[e])}c.appendChild(g),h.appendChild(d),d.className=g.className,d.id=g.id,d.innerHTML=g.innerHTML.replace(a,"<$1font")},r._beforePrint=function(){v.styleSheet.cssText=r.parseCSS(r.getCSS(t.styleSheets,"all")),r.writeHTML()},r.restoreHTML=function(){d.innerHTML="",h.removeChild(d),h.appendChild(g)},r._afterPrint=function(){r.restoreHTML(),v.styleSheet.cssText=""},y(t),y(c);if(r.disablePP)return;p.insertBefore(v,p.firstChild),v.media="print",v.className="iepp-printshim",e.attachEvent("onbeforeprint",r._beforePrint),e.attachEvent("onafterprint",r._afterPrint)}(e,t),i._version=r,i._prefixes=d,i._domPrefixes=v,i.mq=x,i.hasEvent=T,i.testProp=function(e){return M([e])},i.testAllProps=_,i.testStyles=S,i.prefixed=function(e){return _(e,"pfx")},o.className=o.className.replace(/\bno-js\b/,"")+(s?" js "+w.join(" "):""),i}(this,this.document),function(){function C(e,t,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&S.isFunction(e.isEqual))return e.isEqual(t);if(t.isEqual&&S.isFunction(t.isEqual))return t.isEqual(e);var r=a.call(e);if(r!=a.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var i=n.length;while(i--)if(n[i]==e)return!0;n.push(e);var s=0,o=!0;if(r=="[object Array]"){s=e.length,o=s==t.length;if(o)while(s--)if(!(o=s in e==s in t&&C(e[s],t[s],n)))break}else{if("constructor"in e!="constructor"in t||e.constructor!=t.constructor)return!1;for(var u in e)if(S.has(e,u)){s++;if(!(o=S.has(t,u)&&C(e[u],t[u],n)))break}if(o){for(u in t)if(S.has(t,u)&&!(s--))break;o=!s}}return n.pop(),o}var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.slice,u=r.unshift,a=i.toString,f=i.hasOwnProperty,l=r.forEach,c=r.map,h=r.reduce,p=r.reduceRight,d=r.filter,v=r.every,m=r.some,g=r.indexOf,y=r.lastIndexOf,b=Array.isArray,w=Object.keys,E=s.bind,S=function(e){return new P(e)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.3.3";var x=S.each=S.forEach=function(e,t,r){if(e==null)return;if(l&&e.forEach===l)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i,e)===n)return}else for(var o in e)if(S.has(e,o)&&t.call(r,e[o],o,e)===n)return};S.map=S.collect=function(e,t,n){var r=[];return e==null?r:c&&e.map===c?e.map(t,n):(x(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),e.length===+e.length&&(r.length=e.length),r)},S.reduce=S.foldl=S.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduce===h)return r&&(t=S.bind(t,r)),i?e.reduce(t,n):e.reduce(t);x(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},S.reduceRight=S.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduceRight===p)return r&&(t=S.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=S.toArray(e).reverse();return r&&!i&&(t=S.bind(t,r)),i?S.reduce(s,t,n,r):S.reduce(s,t)},S.find=S.detect=function(e,t,n){var r;return T(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},S.filter=S.select=function(e,t,n){var r=[];return e==null?r:d&&e.filter===d?e.filter(t,n):(x(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},S.reject=function(e,t,n){var r=[];return e==null?r:(x(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},S.every=S.all=function(e,t,r){var i=!0;return e==null?i:v&&e.every===v?e.every(t,r):(x(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var T=S.some=S.any=function(e,t,r){t||(t=S.identity);var i=!1;return e==null?i:m&&e.some===m?e.some(t,r):(x(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};S.include=S.contains=function(e,t){var n=!1;return e==null?n:g&&e.indexOf===g?e.indexOf(t)!=-1:(n=T(e,function(e){return e===t}),n)},S.invoke=function(e,t){var n=o.call(arguments,2);return S.map(e,function(e){return(S.isFunction(t)?t||e:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-Infinity;var r={computed:-Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return Infinity;var r={computed:Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},S.shuffle=function(e){var t=[],n;return x(e,function(e,r,i){n=Math.floor(Math.random()*(r+1)),t[r]=t[n],t[n]=e}),t},S.sortBy=function(e,t,n){var r=S.isFunction(t)?t:function(e){return e[t]};return S.pluck(S.map(e,function(e,t,i){return{value:e,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n===void 0?1:r===void 0?-1:n<r?-1:n>r?1:0}),"value")},S.groupBy=function(e,t){var n={},r=S.isFunction(t)?t:function(e){return e[t]};return x(e,function(e,t){var i=r(e,t);(n[i]||(n[i]=[])).push(e)}),n},S.sortedIndex=function(e,t,n){n||(n=S.identity);var r=0,i=e.length;while(r<i){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r},S.toArray=function(e){return e?S.isArray(e)?o.call(e):S.isArguments(e)?o.call(e):e.toArray&&S.isFunction(e.toArray)?e.toArray():S.values(e):[]},S.size=function(e){return S.isArray(e)?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,n){return t!=null&&!n?o.call(e,0,t):e[0]},S.initial=function(e,t,n){return o.call(e,0,e.length-(t==null||n?1:t))},S.last=function(e,t,n){return t!=null&&!n?o.call(e,Math.max(e.length-t,0)):e[e.length-1]},S.rest=S.tail=function(e,t,n){return o.call(e,t==null||n?1:t)},S.compact=function(e){return S.filter(e,function(e){return!!e})},S.flatten=function(e,t){return S.reduce(e,function(e,n){return S.isArray(n)?e.concat(t?n:S.flatten(n)):(e[e.length]=n,e)},[])},S.without=function(e){return S.difference(e,o.call(arguments,1))},S.uniq=S.unique=function(e,t,n){var r=n?S.map(e,n):e,i=[];return e.length<3&&(t=!0),S.reduce(r,function(n,r,s){if(t?S.last(n)!==r||!n.length:!S.include(n,r))n.push(r),i.push(e[s]);return n},[]),i},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=S.intersect=function(e){var t=o.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=S.flatten(o.call(arguments,1),!0);return S.filter(e,function(e){return!S.include(t,e)})},S.zip=function(){var e=o.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=S.pluck(e,""+r);return n},S.indexOf=function(e,t,n){if(e==null)return-1;var r,i;if(n)return r=S.sortedIndex(e,t),e[r]===t?r:-1;if(g&&e.indexOf===g)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(r in e&&e[r]===t)return r;return-1},S.lastIndexOf=function(e,t){if(e==null)return-1;if(y&&e.lastIndexOf===y)return e.lastIndexOf(t);var n=e.length;while(n--)if(n in e&&e[n]===t)return n;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var N=function(){};S.bind=function(t,n){var r,i;if(t.bind===E&&E)return E.apply(t,o.call(arguments,1));if(!S.isFunction(t))throw new TypeError;return i=o.call(arguments,2),r=function(){if(this instanceof r){N.prototype=t.prototype;var e=new N,s=t.apply(e,i.concat(o.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(o.call(arguments)))}},S.bindAll=function(e){var t=o.call(arguments,1);return t.length==0&&(t=S.functions(e)),x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var r=t.apply(this,arguments);return S.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},S.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(o.call(arguments,1)))},S.throttle=function(e,t){var n,r,i,s,o,u,a=S.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&e.apply(n,r),a()};return i||(i=setTimeout(f,t)),s?o=!0:u=e.apply(n,r),a(),s=!0,u}},S.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)};n&&!r&&e.apply(i,s),clearTimeout(r),r=setTimeout(o,t)}},S.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments))}},S.wrap=function(e,t){return function(){var n=[e].concat(o.call(arguments,0));return t.apply(this,n)}},S.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},S.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t},S.values=function(e){return S.map(e,S.identity)},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},S.pick=function(e){var t={};return x(S.flatten(o.call(arguments,1)),function(n){n in e&&(t[n]=e[n])}),t},S.defaults=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e},S.isEqual=function(e,t){return C(e,t,[])},S.isEmpty=function(e){if(e==null)return!0;if(S.isArray(e)||S.isString(e))return e.length===0;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!!e&&e.nodeType==1},S.isArray=b||function(e){return a.call(e)=="[object Array]"},S.isObject=function(e){return e===Object(e)},S.isArguments=function(e){return a.call(e)=="[object Arguments]"},S.isArguments(arguments)||(S.isArguments=function(e){return!!e&&!!S.has(e,"callee")}),S.isFunction=function(e){return a.call(e)=="[object Function]"},S.isString=function(e){return a.call(e)=="[object String]"},S.isNumber=function(e){return a.call(e)=="[object Number]"},S.isFinite=function(e){return S.isNumber(e)&&isFinite(e)},S.isNaN=function(e){return e!==e},S.isBoolean=function(e){return e===!0||e===!1||a.call(e)=="[object Boolean]"},S.isDate=function(e){return a.call(e)=="[object Date]"},S.isRegExp=function(e){return a.call(e)=="[object RegExp]"},S.isNull=function(e){return e===null},S.isUndefined=function(e){return e===void 0},S.has=function(e,t){return f.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},S.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},S.result=function(e,t){if(e==null)return null;var n=e[t];return S.isFunction(n)?n.call(e):n},S.mixin=function(e){x(S.functions(e),function(t){B(t,S[t]=e[t])})};var k=0;S.uniqueId=function(e){var t=k++;return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var O in A)A[A[O]]=O;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,_=/\\(\\|'|r|n|t|u2028|u2029)/g,D=function(e){return e.replace(_,function(e,t){return A[t]})};S.template=function(e,t,n){n=S.defaults(n||{},S.templateSettings);var r="__p+='"+e.replace(M,function(e){return"\\"+A[e]}).replace(n.escape||L,function(e,t){return"'+\n_.escape("+D(t)+")+\n'"}).replace(n.interpolate||L,function(e,t){return"'+\n("+D(t)+")+\n'"}).replace(n.evaluate||L,function(e,t){return"';\n"+D(t)+"\n;__p+='"})+"';\n";n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+r+"return __p;\n";var i=new Function(n.variable||"obj","_",r);if(t)return i(t,S);var s=function(e){return i.call(this,e,S)};return s.source="function("+(n.variable||"obj")+"){\n"+r+"}",s},S.chain=function(e){return S(e).chain()};var P=function(e){this._wrapped=e};S.prototype=P.prototype;var H=function(e,t){return t?S(e).chain():e},B=function(e,t){P.prototype[e]=function(){var e=o.call(arguments);return u.call(e,this._wrapped),H(t.apply(S,e),this._chain)}};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];P.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);var r=n.length;return(e=="shift"||e=="splice")&&r===0&&delete n[0],H(n,this._chain)}}),x(["concat","join","slice"],function(e){var t=r[e];P.prototype[e]=function(){return H(t.apply(this._wrapped,arguments),this._chain)}}),P.prototype.chain=function(){return this._chain=!0,this},P.prototype.value=function(){return this._wrapped}}.call(this);var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){function t(t){return"".trim?t.val().trim():e.trim(t.val())}e.fn.isHappy=function(n){function s(t){return e('<span id="'+t.id+'" class="unhappyMessage">'+t.message+"</span>")}function o(){var e=!1,t,i;for(t=0,i=r.length;t<i;t+=1)r[t].testValid(!0)||(e=!0);if(e)return u(n.unHappy)&&n.unHappy(),!1;if(n.testMode)return window.console&&console.warn("would have submitted"),!1}function u(e){return!!(e&&e.constructor&&e.call&&e.apply)}function a(i,o){var a=e(o),f={message:i.message,id:o.slice(1)+"_unhappy"},l=e(f.id).length>0?e(f.id):s(f);r.push(a),a.testValid=function(n){var r,s=e(this),o,f=!1,c,h=!!s.get(0).attributes.getNamedItem("required")||i.required,p=a.attr("type")==="password",d=u(i.arg)?i.arg():i.arg;return u(i.clean)?r=i.clean(s.val()):!i.trim&&!p?r=t(s):r=s.val(),s.val(r),o=(r.length>0||h==="sometimes")&&u(i.test),n===!0&&h===!0&&r.length===0?f=!0:o&&(f=!i.test(r,d)),f?(s.addClass("unhappy").before(l),!1):(c=l.get(0),c.parentNode&&c.parentNode.removeChild(c),s.removeClass("unhappy"),!0)},a.bind(n.when||"blur",a.testValid)}var r=[],i;for(i in n.fields)a(n.fields[i],i);return n.submitButton?e(n.submitButton).click(o):this.bind("submit",o),this}}(this.jQuery||this.Zepto),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),function(e){window.Footer=Backbone.Model.extend({url:"/assets/footer.json"}),window.FlickrPhotoset=Backbone.Model.extend({}),window.Photosets=Backbone.Model.extend({url:"http://api.flickr.com/services/rest/?method=flickr.photosets.getList&format=json&api_key=beda8cbda2554c1da125362dcf86eab2&user_id=79009288@N07&nojsoncallback=1",photosPerSet:[],initialize:function(){_.bindAll(this,"getId","getSize","fetchPhotos","getTitle","getDescription"),this.bind("change",this.fetchPhotos)},getId:function(e){return this.attributes.photosets.photoset[e].id},getTitle:function(e){return this.attributes.photosets.photoset[e].title._content},getDescription:function(e){return this.attributes.photosets.photoset[e].description._content},getSize:function(){return this.attributes.photosets.photoset.length},fetchPhotos:function(){for(i=0;i<this.getSize();i++)this.photosPerSet.push(new window.PhotosOfPhotoset({setTitle:this.getTitle(i),setDescription:this.getDescription(i)})),this.photosPerSet[i].setPhotoSetId(this.getId(i)),i===this.getSize()-1&&this.photosPerSet[i].setLast(!0),this.photosPerSet[i].fetch()}}),window.PhotosOfPhotoset=Backbone.Model.extend({last:!1,photosetId:0,initialize:function(){_.bindAll(this,"url","setPhotoSetId","getSize","getPhotoUrl","update","setLast","getPhotoTitle"),this.bind("change",this.update)},url:function(){return"http://api.flickr.com/services/rest/?method=flickr.photosets.getPhotos&format=json&api_key=beda8cbda2554c1da125362dcf86eab2&user_id=79009288@N07&photoset_id="+this.photosetId+"&extras=url_l&nojsoncallback=1"},setLast:function(e){this.last=e},setPhotoSetId:function(e){this.photosetId=e},getSize:function(){return this.attributes.photoset?this.attributes.photoset.photo.length:0},getPhotoTitle:function(e){return this.attributes.photoset.photo[e].title},getPhotoUrl:function(e){return this.attributes.photoset.photo[e].url_l},update:function(){var e={id:this.photosetId,title:this.attributes.setTitle,description:this.attributes.setDescription,images:[]};for(k=0;k<this.getSize();k++)e.images.push({id:k,title:this.getPhotoTitle(k),description:this.attributes.setDescription,url:this.getPhotoUrl(k)});window.projectItems.push(new SelectableItem(e))}}),window.TextSection=Backbone.Model.extend({}),window.ResumeSection=Backbone.Model.extend({}),window.Resume=Backbone.Collection.extend({model:ResumeSection,url:"/assets/resume.json"}),window.Writings=Backbone.Collection.extend({model:TextSection,url:"/assets/writings.json"}),window.SelectableItem=Backbone.Model.extend({selected:!1,initialize:function(){_.bindAll(this,"select","unSelect","isSelected")},select:function(){this.selected=!0,this.trigger("change"),this.trigger("select")},unSelect:function(){this.selected=!1,this.trigger("change"),this.trigger("unSelect")},isSelected:function(){return this.selected}}),window.SelectableItems=Backbone.Collection.extend({model:SelectableItem}),window.ProjectItems=SelectableItems.extend({comparator:function(e,t){return e.attributes.id<t.attributes.id}}),window.SelectableModel=Backbone.Model.extend({currentItemIndex:0,initialize:function(){_.bindAll(this,"select","getcurrentItemIndex","getItems","next","previous"),this.bind("select",this.select),this.bind("change",this.selectFirst),this.items=this.attributes.items},select:function(e){e.attributes.url?window.open(e.attributes.url,"_blank"):(this.items.at(this.getcurrentItemIndex()).unSelect(),e.select(),this.currentItemIndex=this.items.indexOf(e),this.trigger("selected",this.currentItemIndex))},getcurrentItemIndex:function(){return this.currentItemIndex},getItems:function(){return this.items},next:function(){this.getcurrentItemIndex()!==this.items.size()-1?this.select(this.items.at(this.getcurrentItemIndex()+1)):this.select(this.items.first())},previous:function(){this.getcurrentItemIndex()!==0?this.select(this.items.at(this.getcurrentItemIndex()-1)):this.select(this.items.last())}}),window.resume=new Resume,window.toolbarItems=new SelectableItems,window.toolbarItems.url="/assets/toolbar.json",window.toolbar=new SelectableModel({items:window.toolbarItems}),window.projectItems=new ProjectItems,window.projectSelector=new SelectableModel({items:window.projectItems}),window.writingItems=new SelectableItems,window.writingItems.url="/assets/writings.json",window.writings=new SelectableModel({items:window.writingItems}),e(document).ready(function(){window.ToolbarItemView=Backbone.View.extend({tag:"div",className:"maja-navigation-toolbar-item",events:{"click .toolbar-click-item":"select"},initialize:function(){_.bindAll(this,"render","select"),this.bind("select",this.render),this.model.bind("change",this.render),this.template=_.template(e("#maja_toolbar_item_template").html()),this.toolbar=this.options.toolbar},render:function(){var t=this.template(this.model.toJSON());return e(this.el).html(t),this.model.selected?e(this.el).addClass("maja-navigation-toolbar-selected"):e(this.el).hasClass("maja-navigation-toolbar-selected")&&e(this.el).removeClass("maja-navigation-toolbar-selected"),this},select:function(){this.toolbar.trigger("select",this.model)}}),window.ToolbarView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render"),this.toolbar=this.options.toolbar,this.toolbar.getItems().bind("reset",this.render),this.toolbar.getItems().bind("change",this.render)},render:function(){var t,n=this.toolbar,r=this.toolbar.getItems();return t=e("#toolbar"),t.empty(),r.each(function(e){var r=new ToolbarItemView({model:e,toolbar:n});t.append(r.render().el)}),this}}),window.ProjectItemView=Backbone.View.extend({tag:"div",className:"maja-gallery-item",events:{"click .maja_project_gallery_item_title":"select","click div.gv_gallery":"select"},initialize:function(){_.bindAll(this,"render","select","update"),this.bind("select",this.update),this.model.bind("change",this.update),this.template=_.template(e("#maja_project_template").html()),this.imageTemplate=_.template(e("#maja_project_image_template").html()),this.gallery=this.options.gallery,this.toolbar=this.options.toolbar,this.galleryViewConfig={transition_speed:2e3,transition_interval:4e3,easing:"swing",show_panels:!0,show_panel_nav:!0,enable_overlays:!1,panel_width:250,panel_height:250,panel_animation:"slide",panel_scale:"crop",overlay_position:"bottom",pan_images:!0,pan_style:"drag",pan_smoothness:15,start_frame:1,show_filmstrip:!1,show_filmstrip_nav:!1,enable_slideshow:!1,autoplay:!1,show_captions:!1,filmstrip_size:3,filmstrip_style:"scroll",filmstrip_position:"bottom",frame_width:60,frame_height:30,frame_opacity:.5,frame_scale:"crop",frame_gap:5,show_infobar:!1,infobar_opacity:1}},render:function(){var t=this.template(this.model.toJSON());e(this.el).html(t),this.model.selected?e(this.el).addClass("maja-gallery-item-selected"):e(this.el).hasClass("maja-gallery-item-selected")&&e(this.el).removeClass("maja-gallery-item-selected"),$projectImagesRoot=e(this.el).find("#maja_gallery_minimized_"+this.model.id),$projectImagesRoot.empty(),$projectImagesRoot.append(this.imageTemplate(this.model.toJSON()));var n=$projectImagesRoot.galleryView(this.galleryViewConfig);return e(".gv_panel > img").on("click",n.showNext),(new ProjectDetailView({model:this.model,toolbar:this.toolbar,gallery:this.gallery})).render(),this},update:function(){this.model.selected?e(this.el).addClass("maja-gallery-item-selected"):e(this.el).hasClass("maja-gallery-item-selected")&&e(this.el).removeClass("maja-gallery-item-selected")},select:function(){this.gallery.trigger("select",this.model)}}),window.ProjectView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","toggle","show","hide"),this.gallery=this.options.gallery,this.gallery.getItems().bind("reset",this.render),this.gallery.getItems().bind("add",this.render),this.gallery.getItems().bind("select",this.hide),this.galleryTemplate=_.template(e("#maja_project_gallery_template").html()),this.selectedIndex=0,this.toolbar=this.options.toolbar,this.toolbar.bind("selected",this.render),this.toolbar.bind("selected",this.toggle)},render:function(){if(this.toolbar.getcurrentItemIndex()===this.selectedIndex){var t=e("#content");t.empty(),t.append(this.galleryTemplate());var n,r=this.gallery,i=this.gallery.getItems();toolbar=this.toolbar,n=t.find("#maja_project_gallery"),n.empty(),i.each(function(e){var t=new ProjectItemView({model:e,gallery:r,toolbar:toolbar});n.append(t.render().el)})}return this},toggle:function(e){e===this.selectedIndex?this.show():this.hide()},show:function(){e("#maja_project_gallery").show()},hide:function(){e("#maja_project_gallery").hide()}}),window.ProjectDetailView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","show","hide","next","previous"),this.selectedIndex=0,this.model.bind("select",this.show),this.model.bind("unSelect",this.hide),this.template=_.template(e("#maja_gallery_detail_template").html()),this.imageTemplate=_.template(e("#maja_project_image_template").html()),this.gallery=this.options.gallery,this.toolbar=this.options.toolbar,this.toolbar.bind("selected",this.hide),this.galleryViewConfig={transition_speed:2e3,transition_interval:4e3,easing:"swing",show_panels:!0,show_panel_nav:!0,enable_overlays:!0,panel_width:1024,panel_height:600,panel_animation:"fade",panel_scale:"fit",overlay_position:"bottom",pan_images:!0,pan_style:"drag",pan_smoothness:15,start_frame:1,show_filmstrip:!0,show_filmstrip_nav:!0,enable_slideshow:!1,autoplay:!1,show_captions:!0,filmstrip_size:3,filmstrip_style:"scroll",filmstrip_position:"bottom",frame_width:164,frame_height:80,frame_opacity:.7,frame_scale:"crop",frame_gap:5,show_infobar:!0,infobar_opacity:1}},render:function(){var t=this.template(this.model.toJSON());return $contentRoot=e("#maja_project_gallery_detail"),$contentRoot.append(t),$projectImagesRoot=$contentRoot.find("#maja_gallery_detail_images_"+this.model.id),$projectImagesRoot.empty(),$projectImagesRoot.append(this.imageTemplate(this.model.toJSON())),this.gv=$projectImagesRoot.galleryView(this.galleryViewConfig),$detailRoot=$contentRoot.find("#maja_gallery_detail_panel_"+this.model.id),$detailRoot.find(".maja-gallery-detail-nav.maja-gallery-detail-right-nav").on("click",this.next),$detailRoot.find(".maja-gallery-detail-nav.maja-gallery-detail-left-nav").on("click",this.previous),$detailRoot.hide(),this},show:function(){e("#maja_gallery_detail_panel_"+this.model.id).show()},hide:function(){e("#maja_gallery_detail_panel_"+this.model.id).hide()},next:function(){this.gallery.next()},previous:function(){this.gallery.previous()}}),window.ResumeView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","toggle","show","hide"),this.selectedIndex=2,this.template=_.template(e("#maja_resume_template").html()),this.toolbar=this.options.toolbar,this.toolbar.bind("selected",this.render),this.toolbar.bind("selected",this.toggle),this.resume=this.options.resume,this.resume.bind("reset",this.render)},render:function(){if(this.toolbar.getcurrentItemIndex()===this.selectedIndex){var t=e("#content");t.empty(),t.append(this.template()),$resumeRoot=t.find("#maja_resume"),collection=this.resume,collection.each(function(e){var t=new ResumeSectionView({model:e,toolbar:toolbar,collection:collection});$resumeRoot.append(t.render().el)}),this.hide()}return this},toggle:function(e){e===this.selectedIndex?this.show():this.hide()},show:function(){e("#maja_resume").show()},hide:function(){e("#maja_resume").hide()}}),window.ResumeSectionView=Backbone.View.extend({className:"maja-resume-section",initialize:function(){_.bindAll(this,"render"),this.collection=this.options.collection,this.template=_.template(e("#maja_resume_section_template").html())},render:function(){var t=this.template(this.model.toJSON());return e(this.el).html(t),this.collection.first()===this.model&&e(this.el).addClass("maja-resume-section-first"),this.collection.last()===this.model&&e(this.el).addClass("maja-resume-section-last"),this}}),window.WritingItemView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","expand","contract","update","select"),this.template=_.template(e("#maja_writings_item_template").html()),this.model.bind("select",this.expand),this.model.bind("unSelect",this.contract),this.writings=this.options.writings,this.collection=this.options.collection},render:function(){var t=this.template(this.model.toJSON());return e(this.el).html(t),e(this.el).find(".maja-writings-sneak-peek").on("click",this.select),this.contract(),this},update:function(){this.model.selected?this.expand():this.contract()},expand:function(){e(this.el).find(".maja-writings-paragraph").show(),e(this.el).find(".maja-writings-sneak-peek").removeClass("hover"),e(this.el).find(".maja-writings-sneak-peek > span").remove()},contract:function(){e(this.el).find(".maja-writings-paragraph").hide(),e(this.el).find(".maja-writings-sneak-peek").addClass("hover"),e(this.el).find(".maja-writings-sneak-peek").append("<span>..</span>")},select:function(){this.writings.trigger("select",this.model)}}),window.WritingsView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","toggle","show","hide"),this.selectedIndex=1,this.template=_.template(e("#maja_writings_template").html()),this.toolbar=this.options.toolbar,this.toolbar.bind("selected",this.render),this.toolbar.bind("selected",this.toggle),this.writings=this.options.writings,this.writings.bind("reset",this.render)},render:function(){if(this.toolbar.getcurrentItemIndex()===this.selectedIndex){var t=e("#content");t.empty(),t.append(this.template()),$writingsRoot=t.find("#maja_writings"),collection=this.writings,collection.each(function(e){var t=new WritingItemView({model:e,writings:writings,collection:collection});$writingsRoot.append(t.render().el)}),this.hide()}return this},toggle:function(e){e===this.selectedIndex?this.show():this.hide()},show:function(){e("#maja_writings").show()},hide:function(){e("#maja_writings").hide()}}),window.Maja=Backbone.Router.extend({routes:{"":"home"},initialize:function(){window.projects=[],window.XDomainRequest&&!jQuery.support.cors&&jQuery.ajaxTransport(function(e){if(e.crossDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var t;return{send:function(n,r){function i(e,n,i,s){t.onload=t.onerror=t.ontimeout=t.onprogress=jQuery.noop,t=undefined,jQuery.event.trigger("ajaxStop"),r(e,n,i,s)}t=new XDomainRequest,t.open(e.type,e.url),t.onload=function(){var e=200,n=t.responseText,r=JSON.parse(t.responseText);r.StatusCode&&r.Message&&(e=r.StatusCode,n=r.Message),i(e,n,{text:n},"Content-Type: "+t.contentType)},t.onerror=function(){i(500,"Unable to Process Data")},t.onprogress=function(){},e.xdrTimeout&&(t.ontimeout=function(){i(0,"timeout")},t.timeout=e.xdrTimeout),t.send(e.hasContent&&e.data||null)},abort:function(){t&&(t.onerror=jQuery.noop(),t.abort())}}}}),window.toolbarItems.fetch({success:function(e,t){e.at(0).select()}}),this.toolbar=new ToolbarView({toolbar:window.toolbar}),window.photosets=new Photosets,window.photosets.fetch({error:function(e,t){alert("peep")}}),window.writingItems.fetch(),window.resume.fetch(),window.projectView=new ProjectView({gallery:window.projectSelector,toolbar:window.toolbar}),this.resumeView=new ResumeView({toolbar:window.toolbar,resume:window.resume}),this.writingsView=new WritingsView({toolbar:window.toolbar,writings:window.writingItems}),this.footer=new Footer,this.footer.fetch({success:function(t,n){$footer=e("#footer");var r=_.template(e("#maja_footer_template").html());$footer.append(r(t.toJSON())),$footer.find("#footer-right").append(window.twittr.widgetEl),$footer.find(".twtr-hd").hide()}})},home:function(){var t=e("#toolbar");t.empty(),t.append(this.toolbar.render().el)}}),e(function(){window.App=new Maja,Backbone.history.start()})})}(jQuery);